---
layout: post
title: "awk command"
description: "awk command"
categories: [Linux]
tags: [Linux Command, Shell Script]
redirect_from:
  - /2020/08/19/
---

* Kramdown table of contents
{:toc .toc}


<br>

![awk](https://user-images.githubusercontent.com/69279022/90589860-0b9bac00-e21a-11ea-9814-48b7b09074e7.png)

# awk

- 데이터를 조작하고 리포트를 생성하기 위해 사용하는 언어
- 리눅스에서 사용하는 awk는 GNU Version의 gawk로 심볼릭 링크되어 있다.
- 간단한 연산자를 Command Line에서 사용할 수 있다

<br>

~~~
$ which wk   
/usr/bin/awk
~~~

~~~
$ ls -l /usr/bin/awk
lrwxrwxrwx 1 root root 4 Jul 24 16:01 /usr/bin/awk -> gawk
~~~

<br>

## Version
- awk : 전통적인 awk
- nwak : New awk
- gawk : GNU awk

<br>    
  
## awk 용어
- 레코드 : 한번에 처리되는 데이터의 양. 기본값으로 라인0
- 필드 : 필드 구분자로 분리된 레코드 내의 데이터
- 레코드구분자 : RS (Record Separator). 레코드와 레코드를 구분하는 구분기호
- 필드 구분자 : FS (Field Separator). 필드와 필드를 구분하는 구분기호
- ORS : Output RS. 출력형태의 레코드 구분자
- OFS : Output FS. 출력형태의 필드 구분자
- NF : Number of Field. 현재 레코드의 필드 개수
- NR : Number of Record. 현재 처리중인 레코드의 번호
- $0 : 전체 레코드 
- $n : 특정 레코드, $1, $2...

<br>

# awk Command 사용법

- awk 명령어를 입력한 다음, ' '(작은따옴표)로 둘러싸인 패턴이나 액션을 입력하고 마지막으로 입력 파일을 입력한다. 만약 입력 파일을 지정하지 않으면 키보드 입력에 의한 표준 입력(stdin)으로 부터 입력을 받게 된다.
- 입력된 라인들의 데이터들의 필드는 **공백 또는 탭** 을 기준으로 분리되어진다

<br>

## 파일로 입력


` awk 형식 `
~~~
$ awk 'Pattern' FileName
$ awk '{ Pattern }' FileName
$ awk 'Pattern { Action }' Filename
~~~

<br>

![t1](https://user-images.githubusercontent.com/69279022/90632460-67d4ef00-e25f-11ea-8580-477f0b13b970.png)

`$ vi ~/test_file `
~~~
홍 길동 3324    5/11/96   50354
임 꺽정 5246    15/9/66   287650
이 성계 7654    6/20/58   60000
정 약용 8683    9/49/48   365000
~~~

![t3](https://user-images.githubusercontent.com/69279022/90634752-29413380-e263-11ea-91ff-0d3c5765cb06.png)
g
` 예제 1 `
~~~
$ awk '/길동/' test_file
~~~
~~~
홍 길동 3324    5/11/96   50354
~~~

→ test_file에서 "길동"을 포함하고 있는 Line을 출력한다.

![t3](https://user-images.githubusercontent.com/69279022/90634752-29413380-e263-11ea-91ff-0d3c5765cb06.png)

` 예제 2 `
~~~
$ awk '{print $1}' test_file
~~~
~~~
홍
임
이
정
~~~

→ test_file에서 첫 번째 필드를 출력한다.

![t3](https://user-images.githubusercontent.com/69279022/90634752-29413380-e263-11ea-91ff-0d3c5765cb06.png)

` 예제 3 `
~~~
$ awk '/홍/{print $1, $2}' test_file
~~~
~~~
홍 길동
~~~

→ test_file에서 "홍"으로 시작되는 Line을 찾고 첫 번째 필드와 두 번째 필드를 출력한다

![t2](https://user-images.githubusercontent.com/69279022/90632462-686d8580-e25f-11ea-8de6-b4cdb8fbe60a.png)


<br>

## 명령어로 입력

` awk 형식 `
~~~
$ Command | awk 'Pattern'
$ Command | awk '{ Pattern }' 
$ Command | awk 'Pattern { Action }'
~~~

<br>

![t1](https://user-images.githubusercontent.com/69279022/90632460-67d4ef00-e25f-11ea-8580-477f0b13b970.png)


` 예제 1 `
~~~
$ df
Filesystem     1K-blocks    Used Available Use% Mounted on
devtmpfs          485220       0    485220   0% /dev
tmpfs             503472       0    503472   0% /dev/shm
tmpfs             503472     432    503040   1% /run
tmpfs             503472       0    503472   0% /sys/fs/cgroup
/dev/xvda1       8376300 1399568   6976732  17% /
tmpfs             100696       0    100696   0% /run/user/1000
~~~
~~~
$ df | awk '$4 < 10000000'
devtmpfs          485220       0    485220   0% /dev
tmpfs             503472       0    503472   0% /dev/shm
tmpfs             503472     432    503040   1% /run
tmpfs             503472       0    503472   0% /sys/fs/cgroup
tmpfs             100696       0    100696   0% /run/user/1000
~~~
→ 4번 째 단락 Available 값이 1,000,000만(1G) Byte 보다 작은 값만 출력한다. 

![t2](https://user-images.githubusercontent.com/69279022/90632462-686d8580-e25f-11ea-8de6-b4cdb8fbe60a.png)

<br>

# Print 함수

- awk 명령의 액션 항목은 {}(중괄호)로 묶어주는데 만약 액션이 지정되지 않고 패턴이 매칭된다면 awk는 매칭된 라인을 모니터에 출력하는 기본 액션을 수행한다.
- print 함수는 Formatting이 필요없이 간단히 출력하는데 사용된다.

<br>

![t1](https://user-images.githubusercontent.com/69279022/90632460-67d4ef00-e25f-11ea-8580-477f0b13b970.png)

` 예제 1 `
~~~
$ date
Wed Aug 19 12:41:06 UTC 2020
~~~
~~~
$ date | awk '{print "Today is " $1 "day" "\n현재시간 : "$4}'
~~~
~~~
Today is Wedday
현재시간 : 12:42:12
~~~

![t3](https://user-images.githubusercontent.com/69279022/90634752-29413380-e263-11ea-91ff-0d3c5765cb06.png)



