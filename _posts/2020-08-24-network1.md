---
layout: post
title: "DNS 기본 동작 원리"
description: "DNS 동작 원리"
categories: [Network]
tags: [Network, DNS, Linux]
redirect_from:
  - /2020/08/23/
---

* Kramdown table of contents
{:toc .toc}

# 1. DNS
>  인터넷 통신을 위해 Domain Name과 IP 주소 정보를 관리하고 매핑하는 분산 데이터베이스 시스템을 DNS(Domain Name System)라고 한다.

` DNS 동작 개요 `
>
![그림1](https://user-images.githubusercontent.com/69279022/90993633-943a9380-e5f0-11ea-9fce-cc5b039d1972.png)

<br>

## 1.2. DNS의 등장 배경
> Internet의 등장 초기에는 Host의 수가 많지 않았기 때문에 Host 이름과 IP 주소 정보를 담고 있는 Host 파일을 사용하였지만, Host의 이름이 변경되거나 Host의 수가 증가함에 따라 Host 이름과 IP 주소 Record를 자동으로 관리하는 쳬계가 필요하게 되었다.

<br>

# 2. DNS의 구성 요소


<br>

## 2.1. Domain Name Space

> DNS는 거대한 분산 Naming System이며 Domain Name Space는 이러한 DNS가 저장/관리하는 계층적 구조를 의미한다.

` DNS 계층적 구조 `

>
![그림2](https://user-images.githubusercontent.com/69279022/90993876-981ae580-e5f1-11ea-89c5-3c4a5ea2c5b4.png)
- Domain Name Space는 최상위 Root DNS Server가 존재하고 그 하위로 Internet에 연결된 모든 Node가 연속해서 이어진 계층 구조로 구성되어 있다.
- 각 Level의 Domain은 그 하위 Domain에 관한 정보를 관리하는 구조이다.

<br>

## 2.2. Name Server

>
![그림3](https://user-images.githubusercontent.com/69279022/90996781-c05b1200-e5fa-11ea-975b-1bd4c66d1101.png)
 - Domain 이름을 IP 주소로 변환하는 것을 Name Service라고 하며 Resolver로 부터 요청 받은 Domain 이름에 대한 IP 정보를 다시 Resolver로 전달해주는 역할을 수행하는 것이 Name Server이다.
- Name Server는 Primary와 Secondary로 구분되며 Primary 해당 Domain을 관리하고 장애로 인하여 동작하지 못하는 경우 Secondary대신 역할을 수행한다.  주기적으로 Primary의 정보를 받아 갱신하여 일관성 있게 유지한다.

<br>

## 2.3. Resovler

> - Resolver는 웹 브라우저 같은 DNS Client의 요청을 Name Server로 전달하고 Name Server로부터 정보(Domain Name 과 IP 주소)를 받아 Client에게 제공하는 기능을 수행한다.
> - Resolver를 단순화하기 위해 Stub Resolver라는 기능을 사용한다. 사용자는 Resovler가 구현된 Name Server의 IP 만 설정해주면 된다.


# DNS의 특징
> - DNS의 계층적 구조에 따라 각 계층을 Domain Level이라고 한다.
> - 각각의 Host는 각 Level에tj 자신을 나타내는 Lable Name을 가지는 동시에 Lable로 시작해서 최상위 Level의 Host Lable까지 점(.)으로 구분하여 연갈한 Domain Name을 가진다.
> - DNS 계층 구조 상에는 Domain과 Zone 이라는 영역이 존재한다.

## 계층적인 도메인 레벨(Hierarchical Domain Level)
> - 네임 스페이스의 트리 구조는 최상위 레벨부터 순차적으로 계층적 소속 관계를 나타내며, 하위 조직의 네임 스페이스를 할당하고 관리하는 방식은 각 하위 기관의 관리 책임자에게 위임된다.
> - 예를 들어 test.com 도메인은 com 도메인을 관리하는 네임 서버에 등록되어 있고, www.test.com은 test.com 도메인을 관리하는 네임 서버에 등록되어 있다. 따라서 test.com 하위에 속하는 하나의 도메인(e.g., mail.test.com)을 생성하기 위해서는 test.com 도메인을 관리하는 네임 서버의 레코드만을 수정함으로써 가능해짂다. 이러한 위임 구조는 호스트의 증가에 대한 관리가 효율적으로 이루어지는 것을 가능하게 한다.

<br>

## Lable Name
> - 각 노드는 0~63 옥텟(Octet) 길이의 레이블 이름을 가지며, 대소문자를 구분하지 않는다
> - 동일한 레벨의 도메인에서는 레이블의 이름이 같을 수 없지만, 동일한 레이블 이름을 다른 레벨에서 사용하는 것은 가능하다.

>
![그림4](https://user-images.githubusercontent.com/69279022/90999426-84777b00-e601-11ea-8202-c0f933e87d38.png)

<br>

## Domain Name
> - 계층적 구조에 따라 레이블이 정의된 각 노드는 최하위 호스트 레이블부터 시작하여 각 경로에 해당하는 모듞 노드의 레이블 사이에 점(.)으로 구분하여 연결한 하나의 고유한 도메인 이름을 갖는다.
> - 자신의 레이블 정보를 가장 왼쪽에 작성하고, 최상위 레벨까지의 경로마다 위치한 레이블을 추가하며 기존 레이블의 오른쪽에 덧붙이는 형태로 구성된다.
> - 각각의 노드는 고유한 이름인 레이블을 가지고 있으며, 해당 노드 이름(레이블 이름)에 상위 도메인 이름을 포함한 것을 FQDN(Fully Qualified Domain Name)이라고 한다. 예를 들어, www라는 호스트의 FQDN은 상위 도메인인 naver.com을 포함한 www.naver.com이다

<br>

## Dmain 과 Zone
> - 도메인(Domain)은 하나의 ‚노드‛가 관리하는 영역, 즉 해당 노드의 하위 영역을 의미한다.
> - 존(Zone)은 하나의 ‚네임 서버‛가 관리하는 영역을 의미한다.

>
![그림5](https://user-images.githubusercontent.com/69279022/90999687-43339b00-e602-11ea-8d83-34a8cd803804.png)


<br><br>

# DNS Message 형식
> 웹 브라우저는 PC에 설정된 DNS 서버(Local DNS 서버)와의 DNS 메시지 교홖을 통해 도메인 이름에 대한 IP 주소 정보를 제공받는다. 이때 Local DNS 서버는 웹 브라우저가 요청한 도메인 이름의 IP 주소를 가지고 있지 않는 경우, 다른 DNS 서버들과의 DNS 메시지 교홖으로 해당 IP 주소를 받아오고 웹 브라우저에게는 마치 자싞이 모든 도메인에 대한 정보를 알고 있는 것처럼 결과 값만 넘겨준다.


## Header

> DNS Message의 기본적인 정보들을 담고 있는 12Byte 고정 길이의 DNS Header
![그림6](https://user-images.githubusercontent.com/69279022/91000361-fb157800-e603-11ea-81c4-dc4fa49d334a.png)
